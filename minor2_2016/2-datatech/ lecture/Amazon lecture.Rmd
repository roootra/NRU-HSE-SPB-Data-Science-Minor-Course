---
title: "Рекомендации"
output:
  slidy_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Что будет в этом модуле

* проекты с рекомендациями по данным Амазон
  * сети
  * тексты
  * разные подходы к построению рекомендаций
  * все ограничено лишь вашими способностями и фантазией 

## Организация работы

* групповая работа
* часть отчетности индивидуальная
* контрольные точки (milestones) 
* презентации (промежуточные и итоговые)

## План работы

* (до следующей недели) разбиение по командам 
* встреча (очно или виртуально) команды
* знакомство с данными
* разработка и обсуждение идей проекта
* распределение обязанностей
* разработка и обсуждение плана
* первые варианты рекомендательных систем
* промежуточная презентация
* интеграция дополнительных данных
* отчеты
* итоговые презентации


## Amazon

* рекомендации в Amazon 
* [www.amazon.com](www.amazon.com)
* зачем рекомендации? А как же "физические", "реальные" магазины?


## Рекомендации фильмов

* на основе чего (features) можно рекомендовать фильмы?
* схожесть фильмов

* [Кинопоиск](https://www.kinopoisk.ru/)
* данные Amazon.com о фильмах

## Не только характеристики

* Выделить полезные характеристики сложно
* Сервисы агрегации мнений
     - https://www.rottentomatoes.com/ 
     - http://www.metacritic.com/ 
* Персонализация: коллаборативная фильтрация
* [Кинопоиск](https://www.kinopoisk.ru/recommend/)
* Amazon: явные и неявные оценки

## Качество рекомендаций: RMSE

* root-mean-square error (корень среднеквадратичной ошибки) -- насколько наше предсказание отличается от реальности

![](https://i.stack.imgur.com/eG03B.png)

## Качество рекомендаций

![](https://hsto.org/getpro/habr/post_images/f1c/a12/f39/f1ca12f3934f6e1906a7b25b52e61903.png)



## ROC-кривая и AUC 

![](https://upload.wikimedia.org/wikipedia/commons/6/6b/Roccurves.png)

## Пример сравнения качества

![](https://hsto.org/getpro/habr/post_images/67f/bd3/7a4/67fbd37a45ce22bfbcd7fb566d87d63a.png)

## Обратно к текстам

* какие тексты нам помогут при рекомендации фильмов?

* tf-idf
* жанры
* темы

Хотим выделить темы автоматически. Как?

## Тематическое моделирование: задача

* Имеется коллекция документов. Хотим обнаружить «темы», из которых она сформирована.

Предположим:

* Каждый документ представляет собой смесь тем.
* «Тема» — набор слов, которые могут с разными вероятностями употребляться при обсуждении данной темы.

## Тематическое моделирование: свойства

* У документа может быть несколько тем.
* У каждого слова — одна тема.
* У каждого документа в коллекции — свое распределение тем (в одном документе представлены только некоторые темы коллекции).

## Тематическое моделирование: пример

![](https://pp.userapi.com/c604724/v604724093/32a01/9kpyrblIiRI.jpg)

## Тематическое моделирование: пример

![](https://pp.userapi.com/c604724/v604724093/32a1c/ko_ScwjjcME.jpg)

## Дополнительные данные

* [IMDb](http://www.imdb.com/)
* [MovieLens](https://movielens.org/)

## Полезные ссылки

* [Рекомендации](http://infolab.stanford.edu/~ullman/mmds/ch9.pdf)
* [Netflix](http://techblog.netflix.com/2012/04/netflix-recommendations-beyond-5-stars.html)
* [Тематическое моделирование на отзывах Amazon](http://kldavenport.com/topic-modeling-amazon-reviews/)